{"version":3,"file":"format-date.cjs","sources":["../src/presets.ts","../src/index.ts"],"sourcesContent":["export enum FormatDatePreset {\n    None,\n    DateTime,\n    DateTimeShort,\n    Date,\n    DateMedium,\n    DateShort,\n}\n\nexport const fetchPreset = (\n    preset: FormatDatePreset,\n    locale: string,\n): Intl.DateTimeFormatOptions => {\n    const hour12 = [\"en-US\"].includes(locale);\n\n    switch (preset) {\n        case FormatDatePreset.None:\n            return {};\n        case FormatDatePreset.DateTime:\n            // \"November 25, 2024 at 15:00\"\n            // \"November 25, 2024 at 3:00 PM\"\n            return {\n                // weekday: \"short\",\n                year: \"numeric\",\n                month: \"long\",\n                day: \"numeric\",\n                hour: \"numeric\",\n                minute: \"numeric\",\n                hour12,\n            };\n        case FormatDatePreset.DateTimeShort:\n            // \"11/25/24, 15:00\"\n            // \"11/25/24, 3:00 PM\"\n            return {\n                dateStyle: \"short\",\n                timeStyle: \"short\",\n                hour12,\n            };\n\n        case FormatDatePreset.Date:\n            // \"November 25, 2024\"\n            return {\n                // dateStyle: \"long\",\n                year: \"numeric\",\n                month: \"long\",\n                day: \"2-digit\",\n            };\n        case FormatDatePreset.DateMedium:\n            // \"Nov 25, 2024\"\n            return {\n                // dateStyle: \"medium\",\n                year: \"numeric\",\n                month: \"short\",\n                day: \"2-digit\",\n            };\n        case FormatDatePreset.DateShort:\n            // \"11/25/24\"\n            return {\n                // dateStyle: \"short\",\n                year: \"numeric\",\n                month: \"2-digit\",\n                day: \"2-digit\",\n            };\n        default:\n            return {\n                dateStyle: \"full\",\n            };\n    }\n};\n","import { EpochUnit, isDate, toDate } from \"@chriscdn/to-date\";\nimport { Memoize } from \"@chriscdn/memoize\";\nimport { fetchPreset, FormatDatePreset } from \"./presets\";\nimport { getUserLocale } from \"get-user-locale\";\n\ntype DateRepresentation = Parameters<typeof toDate>[0];\ntype DateRepresentationNull = DateRepresentation | undefined | null;\nexport { FormatDatePreset } from \"./presets\";\n\nexport type FormatDateOptions = {\n    locale?: string;\n    preset?: FormatDatePreset;\n    formatOptions?: Intl.DateTimeFormatOptions;\n    epochUnit?: EpochUnit;\n};\n\nconst _fetchFormatter = Memoize((\n    locale: string,\n    formatOptions: Intl.DateTimeFormatOptions,\n) => Intl.DateTimeFormat(locale, formatOptions), { maxSize: 20 });\n\nconst _formatDate = Memoize((\n    value: DateRepresentation,\n    locale: string,\n    epochUnit: EpochUnit,\n    formatOptions: Intl.DateTimeFormatOptions,\n) => {\n    const date = toDate(value, epochUnit);\n    const dateFormatter = _fetchFormatter(locale, formatOptions);\n    return isDate(date) ? dateFormatter.format(date) : undefined;\n});\n\n/**\n * Get the browser locale, if possible. This will likely fail in SSR (i.e.,\n * Nuxt). Converts underscores to dashes.\n *\n * @param options {Options}\n * @returns\n */\nconst _browserLocale = Memoize((options: FormatDateOptions) =>\n    (options.locale ??\n        getUserLocale(\n            { fallbackLocale: \"en-GB\" },\n        )).replace(\n            \"_\",\n            \"-\",\n        )\n);\n\nconst formatDate = Memoize(\n    (value: DateRepresentationNull, options: FormatDateOptions = {}) => {\n        if (value === undefined || value === null) {\n            return null;\n        } else {\n            const locale: Intl.LocalesArgument = _browserLocale(options);\n            const preset = options.preset ?? FormatDatePreset.DateTime;\n            const epochUnit = options.epochUnit ?? EpochUnit.BESTGUESS;\n            const formatOptions = options.formatOptions ?? {};\n\n            const intlFormatterOptions = fetchPreset(preset, locale);\n\n            const dateTimeFormatOptions: Intl.DateTimeFormatOptions = {\n                ...intlFormatterOptions,\n                ...formatOptions,\n            };\n\n            return _formatDate(value, locale, epochUnit, dateTimeFormatOptions);\n        }\n    },\n);\n\nexport { formatDate };\n"],"names":["FormatDatePreset","_fetchFormatter","Memoize","locale","formatOptions","Intl","DateTimeFormat","maxSize","_formatDate","value","epochUnit","date","toDate","dateFormatter","isDate","format","undefined","_browserLocale","options","_options$locale","getUserLocale","fallbackLocale","replace","formatDate","_options$preset","_options$epochUnit","_options$formatOption","preset","DateTime","EpochUnit","BESTGUESS","intlFormatterOptions","hour12","includes","None","year","month","day","hour","minute","DateTimeShort","dateStyle","timeStyle","Date","DateMedium","DateShort","fetchPreset","dateTimeFormatOptions","_extends"],"mappings":"IAAYA,qTAAAA,QAAZA,sBAAA,GAAYA,EAAAA,QAAAA,mBAAAA,QAAAA,iBAOX,CAAA,IANGA,EAAA,KAAA,GAAA,OACAA,EAAAA,EAAA,SAAA,GAAA,WACAA,EAAAA,EAAA,cAAA,GAAA,gBACAA,EAAAA,EAAA,KAAA,GAAA,OACAA,EAAAA,EAAA,WAAA,GAAA,aACAA,EAAAA,EAAA,UAAA,GAAA,YAGG,ICODC,EAAkBC,EAAOA,QAAC,SAC5BC,EACAC,UACCC,KAAKC,eAAeH,EAAQC,EAAc,EAAE,CAAEG,QAAS,KAEtDC,EAAcN,EAAOA,QAAC,SACxBO,EACAN,EACAO,EACAN,GAEA,IAAMO,EAAOC,EAAAA,OAAOH,EAAOC,GACrBG,EAAgBZ,EAAgBE,EAAQC,GAC9C,OAAOU,EAAMA,OAACH,GAAQE,EAAcE,OAAOJ,QAAQK,CACvD,GASMC,EAAiBf,EAAAA,QAAQ,SAACgB,GAA0BC,IAAAA,EACtD,OAAeA,OAAfA,EAACD,EAAQf,QAAMgB,EACXC,EAAaA,cACT,CAAEC,eAAgB,WACnBC,QACC,IACA,IACH,GAGHC,EAAarB,EAAAA,QACf,SAACO,EAA+BS,GAC5B,QAD4B,IAAAA,IAAAA,EAA6B,CAAA,GACrDT,QACA,OACH,KAAM,IAAAe,EAAAC,EAAAC,EACGvB,EAA+Bc,EAAeC,GAC9CS,EAAuB,OAAjBH,EAAGN,EAAQS,QAAMH,EAAIxB,QAAgBA,iBAAC4B,SAC5ClB,EAA6B,OAApBe,EAAGP,EAAQR,WAASe,EAAII,EAAAA,UAAUC,UAC3C1B,EAAqC,OAAxBsB,EAAGR,EAAQd,eAAasB,EAAI,CAAA,EAEzCK,EDlDS,SACvBJ,EACAxB,GAEA,IAAM6B,EAAS,CAAC,SAASC,SAAS9B,GAElC,OAAQwB,GACJ,KAAK3B,QAAAA,iBAAiBkC,KAClB,MAAO,CAAE,EACb,KAAKlC,QAAgBA,iBAAC4B,SAGlB,MAAO,CAEHO,KAAM,UACNC,MAAO,OACPC,IAAK,UACLC,KAAM,UACNC,OAAQ,UACRP,OAAAA,GAER,KAAKhC,QAAgBA,iBAACwC,cAGlB,MAAO,CACHC,UAAW,QACXC,UAAW,QACXV,OAAAA,GAGR,KAAKhC,QAAgBA,iBAAC2C,KAElB,MAAO,CAEHR,KAAM,UACNC,MAAO,OACPC,IAAK,WAEb,KAAKrC,QAAAA,iBAAiB4C,WAElB,MAAO,CAEHT,KAAM,UACNC,MAAO,QACPC,IAAK,WAEb,KAAKrC,QAAAA,iBAAiB6C,UAElB,MAAO,CAEHV,KAAM,UACNC,MAAO,UACPC,IAAK,WAEb,QACI,MAAO,CACHI,UAAW,QAG3B,CCTyCK,CAAYnB,EAAQxB,GAE3C4C,EAAqBC,EAAA,CAAA,EACpBjB,EACA3B,GAGP,OAAOI,EAAYC,EAAON,EAAQO,EAAWqC,EAErD"}